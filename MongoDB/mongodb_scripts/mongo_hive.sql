CREATE EXTERNAL TABLE trans_link
( InternalID String,OldID String,RecordInternalID String,ProcessorID String,Terminal String,TxnTypeID String,ResponseCodeID String,RejectCodeID String,BankID String,NetworkID String,TerminalSequenceNumber String,SettlementDate String,SettlementTime String,ActivityDate String,ActivityTime String,Amount String,Fee String,Surcharge String,Interchange String,Txn String,OurBank String,EBTTransaction String,LogID String,P_NetworkCode String,P_TxnCode String,P_ResponseCode String,P_RejectCode String,P_Field1 String,P_Field2 String,ATMInternalID String,EP String,InterchangeCalc String,International String,IchgRateID String,Branded String,DenyTxnType String,CardID String,DCCAmount String,DCCTotal String,DCCTXn String,Deny711 String,CountryCode String,HP4 String,HP5 String,HP6 String,HP7 String,HP8 String,HP9 String,HP10 String,HP11 String,HP12 String,HP13 String,HP14 String,HP15 String,HPCATM String,PAN String )
STORED BY 'com.mongodb.hadoop.hive.MongoStorageHandler'
WITH SERDEPROPERTIES('mongo.columns.mapping'='{"InternalID":"_id","OldID":"OD","RecordInternalID":"RD","ProcessorID":"PD","Terminal":"TL","TxnTypeID":"TT","ResponseCodeID":"RC","RejectCodeID":"RJ","BankID":"BD","NetworkID":"ND","TerminalSequenceNumber":"TS","SettlementDate":"SD","SettlementTime":"ST","ActivityDate":"AD","ActivityTime":"AT","Amount":"AM","Fee":"FE","Surcharge":"SR","Interchange":"IC","Txn":"TN","OurBank":"OB","EBTTransaction":"ET","LogID":"LD","P_NetworkCode":"PN","P_TxnCode":"PT","P_ResponseCode":"PR","P_RejectCode":"PC","P_Field1":"P1","P_Field2":"P2","ATMInternalID":"AI","EP":"EP","InterchangeCalc":"IL","International":"IT","IchgRateID":"IR","Branded":"BR","DenyTxnType":"DT","CardID":"CD","DCCAmount":"DA","DCCTotal":"DL","DCCTXn":"DX","Deny711":"D7","CountryCode":"CC","HP4":"H4","HP5":"H5","HP6":"H6","HP7":"H7","HP8":"H8","HP9":"H9","HP10":"HA","HP11":"HB","HP12":"HC","HP13":"HD","HP14":"HE","HP15":"HF","HPCATM":"HM","PAN":"PA"}')
TBLPROPERTIES('mongo.uri'='mongodb://10.10.29.23:27017/card_cr.trans');


CREATE EXTERNAL TABLE trans_orc
( InternalID String,OldID String,RecordInternalID String,ProcessorID String,Terminal String,TxnTypeID String,ResponseCodeID String,RejectCodeID String,BankID String,NetworkID String,TerminalSequenceNumber String,SettlementTime String,ActivityDate String,ActivityTime String,Amount String,Fee String,Surcharge String,Interchange String,Txn String,OurBank String,EBTTransaction String,LogID String,P_NetworkCode String,P_TxnCode String,P_ResponseCode String,P_RejectCode String,P_Field1 String,P_Field2 String,ATMInternalID String,EP String,InterchangeCalc String,International String,IchgRateID String,Branded String,DenyTxnType String,CardID String,DCCAmount String,DCCTotal String,DCCTXn String,Deny711 String,CountryCode String,HP4 String,HP5 String,HP6 String,HP7 String,HP8 String,HP9 String,HP10 String,HP11 String,HP12 String,HP13 String,HP14 String,HP15 String,HPCATM String,PAN String )
PARTITIONED  by (SettlementDate String) stored as orc;

insert into table trans_orc PARTITION (SettlementDate) select InternalID ,OldID ,RecordInternalID ,ProcessorID ,Terminal ,TxnTypeID ,ResponseCodeID ,RejectCodeID ,BankID ,NetworkID ,TerminalSequenceNumber ,SettlementTime ,ActivityDate ,ActivityTime ,Amount ,Fee ,Surcharge ,Interchange ,Txn ,OurBank ,EBTTransaction ,LogID ,P_NetworkCode ,P_TxnCode ,P_ResponseCode ,P_RejectCode ,P_Field1 ,P_Field2 ,ATMInternalID ,EP ,InterchangeCalc ,International ,IchgRateID ,Branded ,DenyTxnType ,CardID ,DCCAmount ,DCCTotal ,DCCTXn ,Deny711 ,CountryCode ,HP4 ,HP5 ,HP6 ,HP7 ,HP8 ,HP9 ,HP10 ,HP11 ,HP12 ,HP13 ,HP14 ,HP15 ,HPCATM ,PAN,SettlementDate  from trans_link where SettlementDate = '2014-01-01';

insert into table trans_orc PARTITION (SettlementDate) select InternalID ,OldID ,RecordInternalID ,ProcessorID ,Terminal ,TxnTypeID ,ResponseCodeID ,RejectCodeID ,BankID ,NetworkID ,TerminalSequenceNumber ,SettlementTime ,ActivityDate ,ActivityTime ,Amount ,Fee ,Surcharge ,Interchange ,Txn ,OurBank ,EBTTransaction ,LogID ,P_NetworkCode ,P_TxnCode ,P_ResponseCode ,P_RejectCode ,P_Field1 ,P_Field2 ,ATMInternalID ,EP ,InterchangeCalc ,International ,IchgRateID ,Branded ,DenyTxnType ,CardID ,DCCAmount ,DCCTotal ,DCCTXn ,Deny711 ,CountryCode ,HP4 ,HP5 ,HP6 ,HP7 ,HP8 ,HP9 ,HP10 ,HP11 ,HP12 ,HP13 ,HP14 ,HP15 ,HPCATM ,PAN,from_unixtime(unix_timestamp(concat(substr(SettlementDate,1,10),' ',substr(SettlementDate,12,12)),'yyyy-MM-dd HH:mm:ss.SSS'))  from trans_link

insert into table trans_orc PARTITION (from_unixtime(unix_timestamp(concat(substr(SettlementDate,1,10),' ',substr(SettlementDate,12,12)),'yyyy-MM-dd HH:mm:ss.SSS'))(UNIX_TIMESTAMP(SettlementDate,'yyyy-MM-dd'))) select InternalID ,OldID ,RecordInternalID ,ProcessorID ,Terminal ,TxnTypeID ,ResponseCodeID ,RejectCodeID ,BankID ,NetworkID ,TerminalSequenceNumber ,SettlementTime ,ActivityDate ,ActivityTime ,Amount ,Fee ,Surcharge ,Interchange ,Txn ,OurBank ,EBTTransaction ,LogID ,P_NetworkCode ,P_TxnCode ,P_ResponseCode ,P_RejectCode ,P_Field1 ,P_Field2 ,ATMInternalID ,EP ,InterchangeCalc ,International ,IchgRateID ,Branded ,DenyTxnType ,CardID ,DCCAmount ,DCCTotal ,DCCTXn ,Deny711 ,CountryCode ,HP4 ,HP5 ,HP6 ,HP7 ,HP8 ,HP9 ,HP10 ,HP11 ,HP12 ,HP13 ,HP14 ,HP15 ,HPCATM ,PAN,UNIX_TIMESTAMP(SettlementDate,'yyyy-MM-dd')  from trans_link


from_unixtime(unix_timestamp(concat(substr(SettlementDate,1,10),' ',substr(SettlementDate,12,12)),'yyyy-MM-dd HH:mm:ss.SSS'))


CREATE EXTERNAL TABLE trans_link_dev
( InternalID String,OldID String,RecordInternalID String,ProcessorID String,Terminal String,TxnTypeID String,ResponseCodeID String,RejectCodeID String,BankID String,NetworkID String,TerminalSequenceNumber String,SettlementDate String,SettlementTime String,ActivityDate String,ActivityTime String,Amount String,Fee String,Surcharge String,Interchange String,Txn String,OurBank String,EBTTransaction String,LogID String,P_NetworkCode String,P_TxnCode String,P_ResponseCode String,P_RejectCode String,P_Field1 String,P_Field2 String,ATMInternalID String,EP String,InterchangeCalc String,International String,IchgRateID String,Branded String,DenyTxnType String,CardID String,DCCAmount String,DCCTotal String,DCCTXn String,Deny711 String,CountryCode String,HP4 String,HP5 String,HP6 String,HP7 String,HP8 String,HP9 String,HP10 String,HP11 String,HP12 String,HP13 String,HP14 String,HP15 String,HPCATM String,PAN String )
STORED BY 'com.mongodb.hadoop.hive.MongoStorageHandler'
WITH SERDEPROPERTIES('mongo.columns.mapping'='{"InternalID":"_id","OldID":"OD","RecordInternalID":"RD","ProcessorID":"PD","Terminal":"TL","TxnTypeID":"TT","ResponseCodeID":"RC","RejectCodeID":"RJ","BankID":"BD","NetworkID":"ND","TerminalSequenceNumber":"TS","SettlementDate":"SD","SettlementTime":"ST","ActivityDate":"AD","ActivityTime":"AT","Amount":"AM","Fee":"FE","Surcharge":"SR","Interchange":"IC","Txn":"TN","OurBank":"OB","EBTTransaction":"ET","LogID":"LD","P_NetworkCode":"PN","P_TxnCode":"PT","P_ResponseCode":"PR","P_RejectCode":"PC","P_Field1":"P1","P_Field2":"P2","ATMInternalID":"AI","EP":"EP","InterchangeCalc":"IL","International":"IT","IchgRateID":"IR","Branded":"BR","DenyTxnType":"DT","CardID":"CD","DCCAmount":"DA","DCCTotal":"DL","DCCTXn":"DX","Deny711":"D7","CountryCode":"CC","HP4":"H4","HP5":"H5","HP6":"H6","HP7":"H7","HP8":"H8","HP9":"H9","HP10":"HA","HP11":"HB","HP12":"HC","HP13":"HD","HP14":"HE","HP15":"HF","HPCATM":"HM","PAN":"PA"}')
TBLPROPERTIES('mongo.uri'='mongodb://74.208.11.129:27017/cardtronics.transactions');

---------- correct command  mongot-to-hive ----------
CREATE EXTERNAL TABLE transactions_link
( InternalID String,OldID String,RecordInternalID String,ProcessorID String,Terminal String,TxnTypeID String,ResponseCodeID String,RejectCodeID String,BankID String,NetworkID String,TerminalSequenceNumber String,SettlementDate String,SettlementTime String,ActivityDate String,ActivityTime String,Amount String,Fee String,Surcharge String,Interchange String,Txn String,OurBank String,EBTTransaction String,LogID String,P_NetworkCode String,P_TxnCode String,P_ResponseCode String,P_RejectCode String,P_Field1 String,P_Field2 String,ATMInternalID String,EP String,InterchangeCalc String,International String,IchgRateID String,Branded String,DenyTxnType String,CardID String,DCCAmount String,DCCTotal String,DCCTXn String,Deny711 String,CountryCode String,HP4 String,HP5 String,HP6 String,HP7 String,HP8 String,HP9 String,HP10 String,HP11 String,HP12 String,HP13 String,HP14 String,HP15 String,HPCATM String,PAN String )
STORED BY 'com.mongodb.hadoop.hive.MongoStorageHandler'
WITH SERDEPROPERTIES('mongo.columns.mapping'='{"InternalID":"_id","OldID":"OD","RecordInternalID":"RD","ProcessorID":"PD","Terminal":"TL","TxnTypeID":"TT","ResponseCodeID":"RC","RejectCodeID":"RJ","BankID":"BD","NetworkID":"ND","TerminalSequenceNumber":"TS","SettlementDate":"SD","SettlementTime":"ST","ActivityDate":"AD","ActivityTime":"AT","Amount":"AM","Fee":"FE","Surcharge":"SR","Interchange":"IC","Txn":"TN","OurBank":"OB","EBTTransaction":"ET","LogID":"LD","P_NetworkCode":"PN","P_TxnCode":"PT","P_ResponseCode":"PR","P_RejectCode":"PC","P_Field1":"P1","P_Field2":"P2","ATMInternalID":"AI","EP":"EP","InterchangeCalc":"IL","International":"IT","IchgRateID":"IR","Branded":"BR","DenyTxnType":"DT","CardID":"CD","DCCAmount":"DA","DCCTotal":"DL","DCCTXn":"DX","Deny711":"D7","CountryCode":"CC","HP4":"H4","HP5":"H5","HP6":"H6","HP7":"H7","HP8":"H8","HP9":"H9","HP10":"HA","HP11":"HB","HP12":"HC","HPCATM":"HM","PAN":"PA"}')
TBLPROPERTIES('mongo.uri'='mongodb://10.10.29.23:37019/cardtronics.transactions_Bin_1day');


---------- correct command  mongot-to-hive  PRE PROD ----------
CREATE EXTERNAL TABLE atm_link
( InternalID String,OldID String,RecordInternalID String,ProcessorID String,Terminal String,TxnTypeID String,ResponseCodeID String,RejectCodeID String,BankID String,NetworkID String,TerminalSequenceNumber String,SettlementDate String,SettlementTime String,ActivityDate String,ActivityTime String,Amount String,Fee String,Surcharge String,Interchange String,Txn String,OurBank String,EBTTransaction String,LogID String,P_NetworkCode String,P_TxnCode String,P_ResponseCode String,P_RejectCode String,P_Field1 String,P_Field2 String,ATMInternalID String,EP String,InterchangeCalc String,International String,IchgRateID String,Branded String,DenyTxnType String,CardID String,DCCAmount String,DCCTotal String,DCCTXn String,Deny711 String,CountryCode String,HP4 String,HP5 String,HP6 String,HP7 String,HP8 String,HP9 String,HP10 String,HP11 String,HP12 String,HP13 String,HP14 String,HP15 String,HPCATM String,PAN String )
STORED BY 'com.mongodb.hadoop.hive.MongoStorageHandler'
WITH SERDEPROPERTIES('mongo.columns.mapping'='{"InternalID":"_id","OldID":"OD","RecordInternalID":"RD","ProcessorID":"PD","Terminal":"TL","TxnTypeID":"TT","ResponseCodeID":"RC","RejectCodeID":"RJ","BankID":"BD","NetworkID":"ND","TerminalSequenceNumber":"TS","SettlementDate":"SD","SettlementTime":"ST","ActivityDate":"AD","ActivityTime":"AT","Amount":"AM","Fee":"FE","Surcharge":"SR","Interchange":"IC","Txn":"TN","OurBank":"OB","EBTTransaction":"ET","LogID":"LD","P_NetworkCode":"PN","P_TxnCode":"PT","P_ResponseCode":"PR","P_RejectCode":"PC","P_Field1":"P1","P_Field2":"P2","ATMInternalID":"AI","EP":"EP","InterchangeCalc":"IL","International":"IT","IchgRateID":"IR","Branded":"BR","DenyTxnType":"DT","CardID":"CD","DCCAmount":"DA","DCCTotal":"DL","DCCTXn":"DX","Deny711":"D7","CountryCode":"CC","HP4":"H4","HP5":"H5","HP6":"H6","HP7":"H7","HP8":"H8","HP9":"H9","HP10":"HA","HP11":"HB","HP12":"HC","HPCATM":"HM","PAN":"PA"}')
TBLPROPERTIES('mongo.uri'='mongodb://198.251.76.5:27017/cardtronics.import_1day');

---------- correct command  mongot-to-hive ----------
CREATE EXTERNAL TABLE transactions_orc
( InternalID String,OldID String,RecordInternalID String,ProcessorID String,Terminal String,TxnTypeID String,ResponseCodeID String,RejectCodeID String,BankID String,NetworkID String,TerminalSequenceNumber String,SettlementTime String,ActivityDate String,ActivityTime String,Amount String,Fee String,Surcharge String,Interchange String,Txn String,OurBank String,EBTTransaction String,LogID String,P_NetworkCode String,P_TxnCode String,P_ResponseCode String,P_RejectCode String,P_Field1 String,P_Field2 String,ATMInternalID String,EP String,InterchangeCalc String,International String,IchgRateID String,Branded String,DenyTxnType String,CardID String,DCCAmount String,DCCTotal String,DCCTXn String,Deny711 String,CountryCode String,HP4 String,HP5 String,HP6 String,HP7 String,HP8 String,HP9 String,HP10 String,HP11 String,HP12 String,HPCATM String,PAN String )
PARTITIONED  by (SettlementDate String) stored as orc;

---------- local atmtxn ----------
CREATE  TABLE atmtxn
(internalid bigint,oldid bigint,recordinternalid bigint,processorid bigint,terminal string,txntypeid bigint,responsecodeid bigint,rejectcodeid bigint,bankid bigint,settlementdate string,networkid bigint,terminalsequencenumber bigint,settlementtime date,activitydate date,activitytime date,amount double,fee bigint,surcharge double,interchange bigint,txn boolean,ourbank boolean,ebttransaction boolean,logid int,p_networkcode string,p_txncode string,p_responsecode string,p_rejectcode string,p_field1 string,p_field2 string,atminternalid bigint,ep string,interchangecalc double,international boolean,ichgrateid bigint,branded boolean,denytxntype bigint,cardid bigint,dccamount double,dcctotal double,dcctxn boolean,deny711 boolean,countrycode string,hp4 string,hp5 string,hp6 string,hp7 string,hp8 string,hp9 string,hp10 string,hp11 string,hp12 string,hpcatm string,pan string)
stored as orc;

---------- local atmtxn_partition ----------
CREATE  TABLE atmtxn_partition
(internalid bigint,oldid bigint,recordinternalid bigint,processorid bigint,terminal string,txntypeid bigint,responsecodeid bigint,rejectcodeid bigint,bankid bigint,networkid bigint,terminalsequencenumber bigint,settlementtime date,activitydate date,activitytime date,amount double,fee bigint,surcharge double,interchange bigint,txn boolean,ourbank boolean,ebttransaction boolean,logid int,p_networkcode string,p_txncode string,p_responsecode string,p_rejectcode string,p_field1 string,p_field2 string,atminternalid bigint,ep string,interchangecalc double,international boolean,ichgrateid bigint,branded boolean,denytxntype bigint,cardid bigint,dccamount double,dcctotal double,dcctxn boolean,deny711 boolean,countrycode string,hp4 string,hp5 string,hp6 string,hp7 string,hp8 string,hp9 string,hp10 string,hp11 string,hp12 string,hpcatm string,pan string)
PARTITIONED  by (settlementdate string) stored as orc;

---------- local atmtxn_partition INSERT ----------
SET hive.exec.dynamic.partition = true;
SET hive.exec.dynamic.partition.mode = nonstrict;
insert into table atmtxn_partition PARTITION (SettlementDate) select InternalID ,OldID ,RecordInternalID ,ProcessorID ,Terminal ,TxnTypeID ,ResponseCodeID ,RejectCodeID ,BankID ,NetworkID ,TerminalSequenceNumber ,SettlementTime ,ActivityDate ,ActivityTime ,Amount ,Fee ,Surcharge ,Interchange ,Txn ,OurBank ,EBTTransaction ,LogID ,P_NetworkCode ,P_TxnCode ,P_ResponseCode ,P_RejectCode ,P_Field1 ,P_Field2 ,ATMInternalID ,EP ,InterchangeCalc ,International ,IchgRateID ,Branded ,DenyTxnType ,CardID ,DCCAmount ,DCCTotal ,DCCTXn ,Deny711 ,CountryCode ,HP4 ,HP5 ,HP6 ,HP7 ,HP8 ,HP9 ,HP10 ,HP11 ,HP12 ,HPCATM ,PAN,SettlementDate from atmtxn;

CREATE EXTERNAL TABLE transactions_BSON
( InternalID String,OldID String,RecordInternalID String,ProcessorID String,Terminal String,TxnTypeID String,ResponseCodeID String,RejectCodeID String,BankID String,NetworkID String,TerminalSequenceNumber String,SettlementDate String,SettlementTime String,ActivityDate String,ActivityTime String,Amount String,Fee String,Surcharge String,Interchange String,Txn String,OurBank String,EBTTransaction String,LogID String,P_NetworkCode String,P_TxnCode String,P_ResponseCode String,P_RejectCode String,P_Field1 String,P_Field2 String,ATMInternalID String,EP String,InterchangeCalc String,International String,IchgRateID String,Branded String,DenyTxnType String,CardID String,DCCAmount String,DCCTotal String,DCCTXn String,Deny711 String,CountryCode String,HP4 String,HP5 String,HP6 String,HP7 String,HP8 String,HP9 String,HP10 String,HP11 String,HP12 String,HP13 String,HP14 String,HP15 String,HPCATM String,PAN String )
ROW FORMAT SERDE 'com.mongodb.hadoop.hive.BSONSerDe'
WITH SERDEPROPERTIES('mongo.columns.mapping'='{"InternalID":"_id","OldID":"OD","RecordInternalID":"RD","ProcessorID":"PD","Terminal":"TL","TxnTypeID":"TT","ResponseCodeID":"RC","RejectCodeID":"RJ","BankID":"BD","NetworkID":"ND","TerminalSequenceNumber":"TS","SettlementDate":"SD","SettlementTime":"ST","ActivityDate":"AD","ActivityTime":"AT","Amount":"AM","Fee":"FE","Surcharge":"SR","Interchange":"IC","Txn":"TN","OurBank":"OB","EBTTransaction":"ET","LogID":"LD","P_NetworkCode":"PN","P_TxnCode":"PT","P_ResponseCode":"PR","P_RejectCode":"PC","P_Field1":"P1","P_Field2":"P2","ATMInternalID":"AI","EP":"EP","InterchangeCalc":"IL","International":"IT","IchgRateID":"IR","Branded":"BR","DenyTxnType":"DT","CardID":"CD","DCCAmount":"DA","DCCTotal":"DL","DCCTXn":"DX","Deny711":"D7","CountryCode":"CC","HP4":"H4","HP5":"H5","HP6":"H6","HP7":"H7","HP8":"H8","HP9":"H9","HP10":"HA","HP11":"HB","HP12":"HC","HPCATM":"HM","PAN":"PA"}')
STORED AS INPUTFORMAT 'com.mongodb.hadoop.mapred.BSONFileInputFormat' 
OUTPUTFORMAT 'com.mongodb.hadoop.hive.output.HiveBSONFileOutputFormat'

CREATE EXTERNAL TABLE trans_cr_link
( InternalID String,OldID String,RecordInternalID String,ProcessorID String,Terminal String,TxnTypeID String,ResponseCodeID String,RejectCodeID String,BankID String,NetworkID String,TerminalSequenceNumber String,SettlementDate String,SettlementTime String,ActivityDate String,ActivityTime String,Amount String,Fee String,Surcharge String,Interchange String,Txn String,OurBank String,EBTTransaction String,LogID String,P_NetworkCode String,P_TxnCode String,P_ResponseCode String,P_RejectCode String,P_Field1 String,P_Field2 String,ATMInternalID String,EP String,InterchangeCalc String,International String,IchgRateID String,Branded String,DenyTxnType String,CardID String,DCCAmount String,DCCTotal String,DCCTXn String,Deny711 String,CountryCode String,HP4 String,HP5 String,HP6 String,HP7 String,HP8 String,HP9 String,HP10 String,HP11 String,HP12 String,HP13 String,HP14 String,HP15 String,HPCATM String,PAN String )
STORED BY 'com.mongodb.hadoop.hive.MongoStorageHandler'
WITH SERDEPROPERTIES('mongo.columns.mapping'='{"InternalID":"InternalID","OldID":"OldID","RecordInternalID":"RecordInternalID","ProcessorID":"ProcessorID","Terminal":"Terminal","TxnTypeID":"TxnTypeID","ResponseCodeID":"ResponseCodeID","RejectCodeID":"RejectCodeID","BankID":"BankID","NetworkID":"NetworkID","TerminalSequenceNumber":"TerminalSequenceNumber","SettlementDate":"SettlementDate","SettlementTime":"SettlementTime","ActivityDate":"ActivityDate","ActivityTime":"ActivityTime","Amount":"Amount","Fee":"Fee","Surcharge":"Surcharge","Interchange":"Interchange","Txn":"Txn","OurBank":"OurBank","EBTTransaction":"EBTTransaction","LogID":"LogID","P_NetworkCode":"P_NetworkCode","P_TxnCode":"P_TxnCode","P_ResponseCode":"P_ResponseCode","P_RejectCode":"P_RejectCode","P_Field1":"P_Field1","P_Field2":"P_Field2","ATMInternalID":"ATMInternalID","EP":"EP","InterchangeCalc":"InterchangeCalc","International":"International","IchgRateID":"IchgRateID","Branded":"Branded","DenyTxnType":"DenyTxnType","CardID":"CardID","DCCAmount":"DCCAmount","DCCTotal":"DCCTotal","DCCTXn":"DCCTXn","Deny711":"Deny711","CountryCode":"CountryCode","HP4":"HP4","HP5":"HP5","HP6":"HP6","HP7":"HP7","HP8":"HP8","HP9":"HP9","HP10":"HP10","HP11":"HP11","HP12":"HP12","HPCATM":"HPCATM","PAN":"PAN"}') 
TBLPROPERTIES('mongo.uri'='mongodb://10.10.29.23:27017/card_cr.trans_cr_1day');


CREATE EXTERNAL TABLE trans_cr_ORC
( InternalID String,OldID String,RecordInternalID String,ProcessorID String,Terminal String,TxnTypeID String,ResponseCodeID String,RejectCodeID String,BankID String,NetworkID String,TerminalSequenceNumber String,SettlementTime String,ActivityDate String,ActivityTime String,Amount String,Fee String,Surcharge String,Interchange String,Txn String,OurBank String,EBTTransaction String,LogID String,P_NetworkCode String,P_TxnCode String,P_ResponseCode String,P_RejectCode String,P_Field1 String,P_Field2 String,ATMInternalID String,EP String,InterchangeCalc String,International String,IchgRateID String,Branded String,DenyTxnType String,CardID String,DCCAmount String,DCCTotal String,DCCTXn String,Deny711 String,CountryCode String,HP4 String,HP5 String,HP6 String,HP7 String,HP8 String,HP9 String,HP10 String,HP11 String,HP12 String,HPCATM String,PAN String )
PARTITIONED  by (SettlementDate String) stored as orc;


insert into table atmtxn_orc PARTITION (SettlementDate) select InternalID ,OldID ,RecordInternalID ,ProcessorID ,Terminal ,TxnTypeID ,ResponseCodeID ,RejectCodeID ,BankID ,NetworkID ,TerminalSequenceNumber ,SettlementTime ,ActivityDate ,ActivityTime ,Amount ,Fee ,Surcharge ,Interchange ,Txn ,OurBank ,EBTTransaction ,LogID ,P_NetworkCode ,P_TxnCode ,P_ResponseCode ,P_RejectCode ,P_Field1 ,P_Field2 ,ATMInternalID ,EP ,InterchangeCalc ,International ,IchgRateID ,Branded ,DenyTxnType ,CardID ,DCCAmount ,DCCTotal ,DCCTXn ,Deny711 ,CountryCode ,HP4 ,HP5 ,HP6 ,HP7 ,HP8 ,HP9 ,HP10 ,HP11 ,HP12 ,HP13 ,HP14 ,HP15 ,HPCATM ,PAN, SettlementDate  from trans_link_dev where SettlementDate = 'Wed Jan 01 00:00:00 EST 2014';

-- correct command ----------
SET hive.exec.dynamic.partition = true;
SET hive.exec.dynamic.partition.mode = nonstrict;
insert into table transactions_Bin_ORC PARTITION (SettlementDate) select InternalID ,OldID ,RecordInternalID ,ProcessorID ,Terminal ,TxnTypeID ,ResponseCodeID ,RejectCodeID ,BankID ,NetworkID ,TerminalSequenceNumber ,SettlementTime ,ActivityDate ,ActivityTime ,Amount ,Fee ,Surcharge ,Interchange ,Txn ,OurBank ,EBTTransaction ,LogID ,P_NetworkCode ,P_TxnCode ,P_ResponseCode ,P_RejectCode ,P_Field1 ,P_Field2 ,ATMInternalID ,EP ,InterchangeCalc ,International ,IchgRateID ,Branded ,DenyTxnType ,CardID ,DCCAmount ,DCCTotal ,DCCTXn ,Deny711 ,CountryCode ,HP4 ,HP5 ,HP6 ,HP7 ,HP8 ,HP9 ,HP10 ,HP11 ,HP12 ,HPCATM ,PAN,SettlementDate from transactions_Bin_link;

-- correct command ----------
insert into table trans_cr_ORC PARTITION (SettlementDate) select InternalID ,OldID ,RecordInternalID ,ProcessorID ,Terminal ,TxnTypeID ,ResponseCodeID ,RejectCodeID ,BankID ,NetworkID ,TerminalSequenceNumber ,SettlementTime ,ActivityDate ,ActivityTime ,Amount ,Fee ,Surcharge ,Interchange ,Txn ,OurBank ,EBTTransaction ,LogID ,P_NetworkCode ,P_TxnCode ,P_ResponseCode ,P_RejectCode ,P_Field1 ,P_Field2 ,ATMInternalID ,EP ,InterchangeCalc ,International ,IchgRateID ,Branded ,DenyTxnType ,CardID ,DCCAmount ,DCCTotal ,DCCTXn ,Deny711 ,CountryCode ,HP4 ,HP5 ,HP6 ,HP7 ,HP8 ,HP9 ,HP10 ,HP11 ,HP12 ,HPCATM ,PAN,SettlementDate from trans_cr_link;



insert overwrite table atmtxn_orc PARTITION (SettlementDate) select InternalID ,OldID ,RecordInternalID ,ProcessorID ,Terminal ,TxnTypeID ,ResponseCodeID ,RejectCodeID ,BankID ,NetworkID ,TerminalSequenceNumber ,SettlementTime ,ActivityDate ,ActivityTime ,Amount ,Fee ,Surcharge ,Interchange ,Txn ,OurBank ,EBTTransaction ,LogID ,P_NetworkCode ,P_TxnCode ,P_ResponseCode ,P_RejectCode ,P_Field1 ,P_Field2 ,ATMInternalID ,EP ,InterchangeCalc ,International ,IchgRateID ,Branded ,DenyTxnType ,CardID ,DCCAmount ,DCCTotal ,DCCTXn ,Deny711 ,CountryCode ,HP4 ,HP5 ,HP6 ,HP7 ,HP8 ,HP9 ,HP10 ,HP11 ,HP12 ,HPCATM ,PAN,from_unixtime(unix_timestamp(concat(substr(SettlementDate,1,10),' ',substr(SettlementDate,12,12)),'yyyy-MM-dd'))  from atmtxn_staging where SettlementDate = '2014-01-02T05:00:00.000Z';



CREATE EXTERNAL TABLE atmtxn_staging ( InternalID String,OldID String,RecordInternalID String,ProcessorID String,Terminal String,TxnTypeID String,ResponseCodeID String,RejectCodeID String,BankID String,NetworkID String,TerminalSequenceNumber String,SettlementDate String,SettlementTime String,ActivityDate String,ActivityTime String,Amount String,Fee String,Surcharge String,Interchange String,Txn String,OurBank String,EBTTransaction String,LogID String,P_NetworkCode String,P_TxnCode String,P_ResponseCode String,P_RejectCode String,P_Field1 String,P_Field2 String,ATMInternalID String,EP String,InterchangeCalc String,International String,IchgRateID String,Branded String,DenyTxnType String,CardID String,DCCAmount String,DCCTotal String,DCCTXn String,Deny711 String,CountryCode String,HP4 String,HP5 String,HP6 String,HP7 String,HP8 String,HP9 String,HP10 String,HP11 String,HP12 String,HPCATM String,PAN String ) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' STORED AS TEXTFILE;

CREATE EXTERNAL TABLE atmtxn_orc ( InternalID String,OldID String,RecordInternalID String,ProcessorID String,Terminal String,TxnTypeID String,ResponseCodeID String,RejectCodeID String,BankID String,NetworkID String,TerminalSequenceNumber String,SettlementTime String,ActivityDate String,ActivityTime String,Amount String,Fee String,Surcharge String,Interchange String,Txn String,OurBank String,EBTTransaction String,LogID String,P_NetworkCode String,P_TxnCode String,P_ResponseCode String,P_RejectCode String,P_Field1 String,P_Field2 String,ATMInternalID String,EP String,InterchangeCalc String,International String,IchgRateID String,Branded String,DenyTxnType String,CardID String,DCCAmount String,DCCTotal String,DCCTXn String,Deny711 String,CountryCode String,HP4 String,HP5 String,HP6 String,HP7 String,HP8 String,HP9 String,HP10 String,HP11 String,HP12 String,HPCATM String,PAN String )
PARTITIONED BY (SettlementDate String) stored as orc;

-- correct command
LOAD DATA LOCAL INPATH '/root/data/txn.csv' OVERWRITE INTO TABLE atmtxn_staging;

LOAD DATA LOCAL INPATH '/opt/transactions_Bin_1day_agg.bson' OVERWRITE INTO TABLE transactions_BSON;

head -2 /usr/aug.csv

---  Remove first line -----
sed -i 1d /usr/may_4.csv


-------- correct command ----------
SET hive.auto.convert.join=false;
SET hive.exec.dynamic.partition = true;
SET hive.exec.dynamic.partition.mode = nonstrict;
insert into table temp_2014_orc PARTITION (SettlementDate) select a.InternalID as InternalID, a.OldID as OldID, a.RecordInternalID as RecordInternalID, a.ProcessorID as ProcessorID, a.Terminal as Terminal, a.TxnTypeID as TxnTypeID, a.ResponseCodeID as ResponseCodeID, a.RejectCodeID as RejectCodeID, a.BankID as BankID, a.NetworkID as NetworkID, a.TerminalSequenceNumber as TerminalSequenceNumber, b.SettlementTime as SettlementTime, b.ActivityDate as ActivityDate, b.ActivityTime as ActivityTime, a.Amount as Amount, a.Fee as Fee, a.Surcharge as Surcharge, a.Interchange as Interchange, a.Txn as Txn, a.OurBank as OurBank, a.EBTTransaction as EBTTransaction, a.LogID as LogID, a.P_NetworkCode as P_NetworkCode, a.P_TxnCode as P_TxnCode, a.P_ResponseCode as P_ResponseCode, a.P_RejectCode as P_RejectCode, a.P_Field1 as P_Field1, a.P_Field2 as P_Field2, a.ATMInternalID as ATMInternalID, a.EP as EP, a.InterchangeCalc as InterchangeCalc, a.International as International, a.IchgRateID as IchgRateID, a.Branded as Branded, a.DenyTxnType as DenyTxnType, a.CardID as CardID, a.DCCAmount as DCCAmount, a.DCCTotal as DCCTotal, a.DCCTXn as DCCTXn, a.Deny711 as Deny711, a.CountryCode as CountryCode, a.HP4 as HP4, a.HP5 as HP5, a.HP6 as HP6, a.HP7 as HP7, a.HP8 as HP8, a.HP9 as HP9, a.HP10 as HP10, a.HP11 as HP11, a.HP12 as HP12, a.HPCATM as HPCATM, a.PAN as PAN, a.SettlementDate as SettlementDate from atmtxn_2014_orc a left outer join staging_14_new b on a.InternalID=b.InternalID where a.settlementdate >='2014-07-01 00:00:00.0' and a.settlementdate <='2014-07-31 24:00:00.0';

--------  Transformation of Data - 4 columns ---------------
cat /usr/feb.csv | python /opt/python-four.py &> /usr/feb_4.csv


--------  Transformation of Data - 4 columns ---------------
CREATE EXTERNAL TABLE locationdetails_temp_link
( ATMInternalID string,ATMLevel string,ATMMemo string,ATMStatus string,AccountingClass string,AddOrSwap string,AllpointOptIn string,AllpointOptOut string,ArmCarID_UI string,ArmoredCarrier string,Arrangement string,BusinessLine string,BusinessTypeTerminal string,CONNECTION string,CardOwnsPhoneLine string,CardlinkID string,Contact string,ContactAddr1 string,ContractAddr2 string,CreateDate string,CustContractEnd string,CustContractStart string,DMA string,DUNSNumber string,DateDeinstalled string,DateInstalled string,Division string,Email string,EntityInternalID string,Fax string,FirstLineMaintCost string,FirstLineMaintVendor string,FirstLineTid string,FirstTransdate string,FreePaper string,FutureTID string,GPVendor string,HrsFriClose string,HrsFriOpen string,HrsMonClose string,HrsMonOpen string,HrsSatClose string,HrsSatOpen string,HrsSunClose string,HrsSunOpen string,HrsThuClose string,HrsThuOpen string,HrsTueClose string,HrsTueOpen string,HrsWedClose string,HrsWedOpen string,InactivityCondition string,Installer string,InsuranceFee string,InterchangePCTValue string,KeyCustodian string,LastTransDate string,Latitude string,Location string,LocationAddress string,LocationCellPhone string,LocationCity string,LocationContactPhone string,LocationCountry string,LocationCounty string,LocationState string,LocationZip string,Longitude string,MAILSTOP string,MSA string,MachineType string,Make string,MakeModel string,Market string,MaxWithdrawal string,MemoAlert string,MercGuarantee string,MerchSurchargeShare string,MerchantSCSharePCTValue string,Model string,MonitorByGasper string,MonitorCash string,NetworkMgmt string,OwnerAddress string,OwnerCity string,OwnerCountry string,OwnerEmail string,OwnerFax string,OwnerID_UI string,OwnerName string,OwnerState string,OwnerZip string,ParticipantID string,PatriotDocsRecd string,Processor string,ProcessorID string,ProcessorID_UI string,Program string,Region string,SNinternalid_UI string,SalesRep string,SeasonalApr string,SeasonalAug string,SeasonalDec string,SeasonalFeb string,SeasonalJan string,SeasonalJul string,SeasonalJune string,SeasonalMar string,SeasonalMay string,SeasonalNov string,SeasonalOct string,SeasonalSep string,SecondLineMaintCost string,SecondLineMaintVendor string,SecondLineTid string,SerialNo string,Service1End string,Service1Start string,Service2End string,Service2Start string,StatementFee string,Store string,SubProgram string,Surcharge string,SurchargeBalInq string,SurchargeDomestic string,SurchargeIntl string,SurchargeMinimum string,SurchargePCTValue string,TerminalID string,TimeZone string,TimeZoneDST string,VATPCT string,VisaTier string,VisaTierID string,WarrantyCost string,WarrantyCoverage string,WarrantyEnd string,WarrantyStart string,ZONE string )
STORED BY 'com.mongodb.hadoop.hive.MongoStorageHandler'
WITH SERDEPROPERTIES('mongo.columns.mapping'='{"ATMInternalID":"ATMInternalID","ATMLevel":"ATMLevel","ATMMemo":"ATMMemo","ATMStatus":"ATMStatus","AccountingClass":"AccountingClass","AddOrSwap":"AddOrSwap","AllpointOptIn":"Allpoint Opt in","AllpointOptOut":"Allpoint Opt out","ArmCarID_UI":"ArmCarID_UI","ArmoredCarrier":"ArmoredCarrier","Arrangement":"Arrangement","BusinessLine":"BusinessLine","BusinessTypeTerminal":"BusinessTypeTerminal","CONNECTION":"CONNECTION","CardOwnsPhoneLine":"CardOwnsPhoneLine","CardlinkID":"CardlinkID","Contact":"Contact","ContactAddr1":"ContactAddr1","ContractAddr2":"ContractAddr2","CreateDate":"CreateDate","CustContractEnd":"CustContractEnd","CustContractStart":"CustContractStart","DMA":"DMA","DUNSNumber":"DUNSNumber","DateDeinstalled":"DateDeinstalled","DateInstalled":"DateInstalled","Division":"Division","Email":"Email","EntityInternalID":"EntityInternalID","Fax":"Fax","FirstLineMaintCost":"FirstLineMaintCost","FirstLineMaintVendor":"FirstLineMaintVendor","FirstLineTid":"FirstLineTid","FirstTransdate":"FirstTransdate","FreePaper":"FreePaper","FutureTID":"FutureTID","GPVendor":"GPVendor","HrsFriClose":"HrsFriClose","HrsFriOpen":"HrsFriOpen","HrsMonClose":"HrsMonClose","HrsMonOpen":"HrsMonOpen","HrsSatClose":"HrsSatClose","HrsSatOpen":"HrsSatOpen","HrsSunClose":"HrsSunClose","HrsSunOpen":"HrsSunOpen","HrsThuClose":"HrsThuClose","HrsThuOpen":"HrsThuOpen","HrsTueClose":"HrsTueClose","HrsTueOpen":"HrsTueOpen","HrsWedClose":"HrsWedClose","HrsWedOpen":"HrsWedOpen","InactivityCondition":"InactivityCondition","Installer":"Installer","InsuranceFee":"InsuranceFee","InterchangePCTValue":"InterchangePCTValue","KeyCustodian":"KeyCustodian","LastTransDate":"LastTransDate","Latitude":"Latitude","Location":"Location","LocationAddress":"LocationAddress","LocationCellPhone":"LocationCellPhone","LocationCity":"LocationCity","LocationContactPhone":"LocationContactPhone","LocationCountry":"LocationCountry","LocationCounty":"LocationCounty","LocationState":"LocationState","LocationZip":"LocationZip","Longitude":"Longitude","MAILSTOP":"MAILSTOP","MSA":"MSA","MachineType":"MachineType","Make":"Make","MakeModel":"MakeModel","Market":"Market","MaxWithdrawal":"MaxWithdrawal","MemoAlert":"MemoAlert","MercGuarantee":"MercGuarantee","MerchSurchargeShare":"MerchSurchargeShare","MerchantSCSharePCTValue":"MerchantSCSharePCTValue","Model":"Model","MonitorByGasper":"MonitorByGasper","MonitorCash":"MonitorCash","NetworkMgmt":"NetworkMgmt","OwnerAddress":"OwnerAddress","OwnerCity":"OwnerCity","OwnerCountry":"OwnerCountry","OwnerEmail":"OwnerEmail","OwnerFax":"OwnerFax","OwnerID_UI":"OwnerID_UI","OwnerName":"OwnerName","OwnerState":"OwnerState","OwnerZip":"OwnerZip","ParticipantID":"ParticipantID","PatriotDocsRecd":"PatriotDocsRecd","Processor":"Processor","ProcessorID":"ProcessorID","ProcessorID_UI":"ProcessorID_UI","Program":"Program","Region":"Region","SNinternalid_UI":"SNinternalid_UI","SalesRep":"SalesRep","SeasonalApr":"SeasonalApr","SeasonalAug":"SeasonalAug","SeasonalDec":"SeasonalDec","SeasonalFeb":"SeasonalFeb","SeasonalJan":"SeasonalJan","SeasonalJul":"SeasonalJul","SeasonalJune":"SeasonalJune","SeasonalMar":"SeasonalMar","SeasonalMay":"SeasonalMay","SeasonalNov":"SeasonalNov","SeasonalOct":"SeasonalOct","SeasonalSep":"SeasonalSep","SecondLineMaintCost":"SecondLineMaintCost","SecondLineMaintVendor":"SecondLineMaintVendor","SecondLineTid":"SecondLineTid","SerialNo":"SerialNo","Service1End":"Service1End","Service1Start":"Service1Start","Service2End":"Service2End","Service2Start":"Service2Start","StatementFee":"StatementFee","Store":"Store","SubProgram":"SubProgram","Surcharge":"Surcharge","SurchargeBalInq":"SurchargeBalInq","SurchargeDomestic":"SurchargeDomestic","SurchargeIntl":"SurchargeIntl","SurchargeMinimum":"SurchargeMinimum","SurchargePCTValue":"SurchargePCTValue","TerminalID":"TerminalID","TimeZone":"TimeZone","TimeZoneDST":"TimeZoneDST","VATPCT":"VATPCT","VisaTier":"VisaTier","VisaTierID":"VisaTierID","WarrantyCost":"WarrantyCost","WarrantyCoverage":"WarrantyCoverage","WarrantyEnd":"WarrantyEnd","WarrantyStart":"WarrantyStart","ZONE":"ZONE"}')
TBLPROPERTIES('mongo.uri'='mongodb://198.251.76.5:27017/cardtronics.LocationDetails_temp','serialization.null.format'='');



CREATE EXTERNAL TABLE locationdetails_temp_link_2
( ATMInternalID string,ATMLevel string,ATMMemo string,ATMStatus string,AccountingClass string,AddOrSwap string,AllpointOptIn string,AllpointOptOut string,ArmCarID_UI string,ArmoredCarrier string,Arrangement string,BusinessLine string,BusinessTypeTerminal string,CONNECTION string,CardOwnsPhoneLine string,CardlinkID string,Contact string,ContactAddr1 string,ContractAddr2 string,CreateDate string,CustContractEnd string,CustContractStart string,DMA string,DUNSNumber string,DateDeinstalled string,DateInstalled string,Division string,Email string,EntityInternalID string,Fax string,FirstLineMaintCost string,FirstLineMaintVendor string,FirstLineTid string,FirstTransdate string,FreePaper string,FutureTID string,GPVendor string,HrsFriClose string,HrsFriOpen string,HrsMonClose string,HrsMonOpen string,HrsSatClose string,HrsSatOpen string,HrsSunClose string,HrsSunOpen string,HrsThuClose string,HrsThuOpen string,HrsTueClose string,HrsTueOpen string,HrsWedClose string,HrsWedOpen string,InactivityCondition string,Installer string,InsuranceFee string,InterchangePCTValue string,KeyCustodian string,LastTransDate string,Latitude string,Location string,LocationAddress string,LocationCellPhone string,LocationCity string,LocationContactPhone string,LocationCountry string,LocationCounty string,LocationState string,LocationZip string,Longitude string,MAILSTOP string,MSA string,MachineType string,Make string,MakeModel string,Market string,MaxWithdrawal string,MemoAlert string,MercGuarantee string,MerchSurchargeShare string,MerchantSCSharePCTValue string,Model string,MonitorByGasper string,MonitorCash string,NetworkMgmt string,OwnerAddress string,OwnerCity string,OwnerCountry string,OwnerEmail string,OwnerFax string,OwnerID_UI string,OwnerName string,OwnerState string,OwnerZip string,ParticipantID string,PatriotDocsRecd string,Processor string,ProcessorID string,ProcessorID_UI string,Program string,Region string,SNinternalid_UI string,SalesRep string,SeasonalApr string,SeasonalAug string,SeasonalDec string,SeasonalFeb string,SeasonalJan string,SeasonalJul string,SeasonalJune string,SeasonalMar string,SeasonalMay string,SeasonalNov string,SeasonalOct string,SeasonalSep string,SecondLineMaintCost string,SecondLineMaintVendor string,SecondLineTid string,SerialNo string,Service1End string,Service1Start string,Service2End string,Service2Start string,StatementFee string,Store string,SubProgram string,Surcharge string,SurchargeBalInq string,SurchargeDomestic string,SurchargeIntl string,SurchargeMinimum string,SurchargePCTValue string,TerminalID string,TimeZone string,TimeZoneDST string,VATPCT string,VisaTier string,VisaTierID string,WarrantyCost string,WarrantyCoverage string,WarrantyEnd string,WarrantyStart string,ZONE string )
STORED BY 'com.mongodb.hadoop.hive.MongoStorageHandler'
WITH SERDEPROPERTIES('mongo.columns.mapping'='{"ATMInternalID":"ATMInternalID","ATMLevel":"ATMLevel","ATMMemo":"ATMMemo","ATMStatus":"ATMStatus","AccountingClass":"AccountingClass","AddOrSwap":"AddOrSwap","ArmCarID_UI":"ArmCarID_UI","ArmoredCarrier":"ArmoredCarrier","Arrangement":"Arrangement","BusinessLine":"BusinessLine","BusinessTypeTerminal":"BusinessTypeTerminal","CONNECTION":"CONNECTION","CardOwnsPhoneLine":"CardOwnsPhoneLine","CardlinkID":"CardlinkID","Contact":"Contact","ContactAddr1":"ContactAddr1","ContractAddr2":"ContractAddr2","CreateDate":"CreateDate","CustContractEnd":"CustContractEnd","CustContractStart":"CustContractStart","DMA":"DMA","DUNSNumber":"DUNSNumber","DateDeinstalled":"DateDeinstalled","DateInstalled":"DateInstalled","Division":"Division","Email":"Email","EntityInternalID":"EntityInternalID","Fax":"Fax","FirstLineMaintCost":"FirstLineMaintCost","FirstLineMaintVendor":"FirstLineMaintVendor","FirstLineTid":"FirstLineTid","FirstTransdate":"FirstTransdate","FreePaper":"FreePaper","FutureTID":"FutureTID","GPVendor":"GPVendor","HrsFriClose":"HrsFriClose","HrsFriOpen":"HrsFriOpen","HrsMonClose":"HrsMonClose","HrsMonOpen":"HrsMonOpen","HrsSatClose":"HrsSatClose","HrsSatOpen":"HrsSatOpen","HrsSunClose":"HrsSunClose","HrsSunOpen":"HrsSunOpen","HrsThuClose":"HrsThuClose","HrsThuOpen":"HrsThuOpen","HrsTueClose":"HrsTueClose","HrsTueOpen":"HrsTueOpen","HrsWedClose":"HrsWedClose","HrsWedOpen":"HrsWedOpen","InactivityCondition":"InactivityCondition","Installer":"Installer","InsuranceFee":"InsuranceFee","InterchangePCTValue":"InterchangePCTValue","KeyCustodian":"KeyCustodian","LastTransDate":"LastTransDate","Latitude":"Latitude","Location":"Location","LocationAddress":"LocationAddress","LocationCellPhone":"LocationCellPhone","LocationCity":"LocationCity","LocationContactPhone":"LocationContactPhone","LocationCountry":"LocationCountry","LocationCounty":"LocationCounty","LocationState":"LocationState","LocationZip":"LocationZip","Longitude":"Longitude","MAILSTOP":"MAILSTOP","MSA":"MSA","MachineType":"MachineType","Make":"Make","MakeModel":"MakeModel","Market":"Market","MaxWithdrawal":"MaxWithdrawal","MemoAlert":"MemoAlert","MercGuarantee":"MercGuarantee","MerchSurchargeShare":"MerchSurchargeShare","MerchantSCSharePCTValue":"MerchantSCSharePCTValue","Model":"Model","MonitorByGasper":"MonitorByGasper","MonitorCash":"MonitorCash","NetworkMgmt":"NetworkMgmt","OwnerAddress":"OwnerAddress","OwnerCity":"OwnerCity","OwnerCountry":"OwnerCountry","OwnerEmail":"OwnerEmail","OwnerFax":"OwnerFax","OwnerID_UI":"OwnerID_UI","OwnerName":"OwnerName","OwnerState":"OwnerState","OwnerZip":"OwnerZip","ParticipantID":"ParticipantID","PatriotDocsRecd":"PatriotDocsRecd","Processor":"Processor","ProcessorID":"ProcessorID","ProcessorID_UI":"ProcessorID_UI","Program":"Program","Region":"Region","SNinternalid_UI":"SNinternalid_UI","SalesRep":"SalesRep","SeasonalApr":"SeasonalApr","SeasonalAug":"SeasonalAug","SeasonalDec":"SeasonalDec","SeasonalFeb":"SeasonalFeb","SeasonalJan":"SeasonalJan","SeasonalJul":"SeasonalJul","SeasonalJune":"SeasonalJune","SeasonalMar":"SeasonalMar","SeasonalMay":"SeasonalMay","SeasonalNov":"SeasonalNov","SeasonalOct":"SeasonalOct","SeasonalSep":"SeasonalSep","SecondLineMaintCost":"SecondLineMaintCost","SecondLineMaintVendor":"SecondLineMaintVendor","SecondLineTid":"SecondLineTid","SerialNo":"SerialNo","Service1End":"Service1End","Service1Start":"Service1Start","Service2End":"Service2End","Service2Start":"Service2Start","StatementFee":"StatementFee","Store":"Store","SubProgram":"SubProgram","Surcharge":"Surcharge","SurchargeBalInq":"SurchargeBalInq","SurchargeDomestic":"SurchargeDomestic","SurchargeIntl":"SurchargeIntl","SurchargeMinimum":"SurchargeMinimum","SurchargePCTValue":"SurchargePCTValue","TerminalID":"TerminalID","TimeZone":"TimeZone","TimeZoneDST":"TimeZoneDST","VATPCT":"VATPCT","VisaTier":"VisaTier","VisaTierID":"VisaTierID","WarrantyCost":"WarrantyCost","WarrantyCoverage":"WarrantyCoverage","WarrantyEnd":"WarrantyEnd","WarrantyStart":"WarrantyStart","ZONE":"ZONE"}')
TBLPROPERTIES('mongo.uri'='mongodb://198.251.76.5:27017/cardtronics.LocationDetails_temp','serialization.null.format'='');



CREATE  EXTERNAL TABLE txntype_link
(code string,description string)
STORED BY 'com.mongodb.hadoop.hive.MongoStorageHandler'
WITH SERDEPROPERTIES('mongo.columns.mapping'='{"code":"Code","description":"Description"}')
TBLPROPERTIES('mongo.uri'='mongodb://198.251.76.5:27017/cardtronics.TxnType','serialization.null.format'='');